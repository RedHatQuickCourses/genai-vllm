<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mistral LLM Model Inference :: vLLM Optimizing and Serving Models on OpenShift AI</title>
    <link rel="prev" href="section1.html">
    <link rel="next" href="section3.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">vLLM Optimizing and Serving Models on OpenShift AI</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="vLLM Optimizing and Serving Models on OpenShift AI" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">vLLM Optimizing and Serving Models on OpenShift AI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../vllm/index.html">vLLM, What is it?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vllm/vllm_intro.html">vLLM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vllm/rh_ai.html">Red Hat AI Platforms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vllm/vllm_rhoai.html">Integrating vLLM with OpenShift AI: The Serving Runtime</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vllm/vllm_deploy.html">vLLM on Red Hat OpenShift AI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../vllm/vllm_concl.html">Summary: Key Takeaways and Next Steps</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../model_sizing/index.html">GPU Architecture and Model Sizing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../model_sizing/gpu_arch.html">NVIDIA GPU Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../model_sizing/gpu_cost.html">Estimating GPU VRAM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../model_sizing/vram_calc.html">Cost-Effective Model Selection</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../rh_hg_ai/index.html">Red Hat AI Model Repository</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rh_hg_ai/model_types.html">Generative AI Model Variations in Model Naming</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rh_hg_ai/val_models.html">Validated Models and Quantization Strategies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rh_hg_ai/lab_models.html">Pre-Selected Course Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rh_hg_ai/summary.html">From Curation to Confident Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../rhoai_deploy/index.html">OpenShift AI Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_self.html">Optional - RHOAI Self-Managed</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_221.html">Lab Environment Customization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_config.html">Project and Data Connection Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_bench.html">Creating the AI Workbench and Preparing Models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_model.html">Deploy Granite LLM on RHOAI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/rhoai_query.html">Querying the Deployed Model in a Jupyter Notebook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/section7.html">Using the AI Model for Summarization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../rhoai_deploy/add_runtime.html">vLLM Serving Runtime</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Jupyter Notebooks &amp; LLMs</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.html">Jupyter Notebooks</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section2.html">Mistral LLM Model Inference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">Llama3 LLM Model Inference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter9/index.html">blank</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter9/section4.html">blank</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter9/section2.html">blank</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter9/section3.html">blank</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appendix/further_study.html">Hands on Exploration and Further Study</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../LABENV/index.html">Lab Environments</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../LABENV/index-lab-demo.html">Red Hat Demo Hub: Lab Environment Selection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../LABENV/developer_sandbox.html">Red Hat Developer Platform</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">vLLM Optimizing and Serving Models on OpenShift AI</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">vLLM Optimizing and Serving Models on OpenShift AI</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">vLLM Optimizing and Serving Models on OpenShift AI</a></li>
    <li><a href="index.html">Jupyter Notebooks &amp; LLMs</a></li>
    <li><a href="section2.html">Mistral LLM Model Inference</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Mistral LLM Model Inference</h1>
<div class="sect1">
<h2 id="_lets_talk_with_the_llm"><a class="anchor" href="#_lets_talk_with_the_llm"></a>Let&#8217;s Talk with the LLM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The blue indicator on the left should now be located at the first input cell.  If you have not executed or run all the cells above, please do so now.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/first_input.png" alt="first input" width="640">
</div>
</div>
<div class="sect2">
<h3 id="_first_input"><a class="anchor" href="#_first_input"></a>First Input</h3>
<div class="paragraph">
<p>The first input cell sent via the notebook to the Mistral model askes it to describe: <strong>"Paris in 100 words or less".</strong>  Go ahead and run this cell.</p>
</div>
<div class="paragraph">
<p>Immediately, green text is shown in the notebook, this is the entire prompt that is sent along with the single sentence question. There are three parts to the prompt:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The System message which describes to the model how to consider and respond to the question</p>
</li>
<li>
<p>The current conversation section, which describes the prompt or question to consider</p>
</li>
<li>
<p>The response from Mistral Model, which is currently processing and will appear in black text</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It takes a few seconds for the OpenShift AI model to respond with the first words of the reply. The response answered the question in a well-considered informative paragraph that meets the requirement of less than 100 words in length.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/first_input_response.png" alt="first input response" width="800">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_second_input"><a class="anchor" href="#_second_input"></a>Second Input</h3>
<div class="paragraph">
<p>The Second input - "Is there a River" - does not specify where the location is. Due to the conversation history being passed with the second input, there is no need to specify any additional information. Shown in the current conversation section below, notice the first input and the response was included with the second input.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/second_input.png" alt="second input" width="800">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_second_example"><a class="anchor" href="#_second_example"></a>Second Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we continue with the London example, we execute a cell to  change the conversation mode to non-verbose. This eliminates the context of the prompt displayed in the notebook to instead just show the model&#8217;s reply.</p>
</div>
<div class="paragraph">
<p>We also execute a cell to clear memory, or the conversation history regarding Paris.</p>
</div>
<div class="paragraph">
<p>We did not disable the memory, or the verbosity of the conversation; we simply hid that section from being visible in the notebook.</p>
</div>
<div class="paragraph">
<p>Go ahead, run the second example cells and evaluate the responses from the model.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/second_example_response.png" alt="second example response" width="800">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_experiment_with_mistral"><a class="anchor" href="#_experiment_with_mistral"></a>Experiment with Mistral</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are multiple different types of large language models, while we can read about them, using them first hand is the best way to experience how they perform.</p>
</div>
<div class="paragraph">
<p>So now it&#8217;s time to experiment on your own, or optionally continue to follow along with this guide.</p>
</div>
<div class="paragraph">
<p>Add a few new cells to the bottom of the Notebook.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/experiment_setup.png" alt="experiment setup" width="640">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Experiment by copying the clear conversation cell text, paste the contents into one of the new cells</p>
</li>
<li>
<p>Next copy one of the input statements, replace the prompt / question for the model.  Then run or execute those cells to learn more about the models capabilities</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>I used the following examples:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Are you an AI model ?</p>
</li>
<li>
<p>Tell me a joke please ?</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then I asked one of my standard questions across models to determine it&#8217;s knowledge of history:</p>
</div>
<div class="paragraph">
<p><strong>Was George Washington Married?</strong></p>
</div>
<div class="paragraph">
<p>Why I ask this question is because several models say GW was married twice. I believed the first one, and this had me thinking several of the next models were wrong. It&#8217;s critical that we evaluate models to determine their viability for business use cases.   The Mistral model was wrong in this instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/experiment1.png" alt="experiment1" width="800">
</div>
</div>
<div class="paragraph">
<p>Try clearing the memory again and asking more of your own questions to continue to experiment with the Mistral model.</p>
</div>
<div class="paragraph">
<p>When you&#8217;re ready, move to the next section, where we evaluate a different large language model.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section1.html">Jupyter Notebooks</a></span>
  <span class="next"><a href="section3.html">Llama3 LLM Model Inference</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
